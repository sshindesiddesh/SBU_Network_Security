This is passive network monitoring application. It captures traffic from a network interface in promiscous network or reads from a trace file.

Software Design:
	

Application User Interface:
	mydump [-i interface] [-r file] [-s string] expression

	-i  Live capture from the network device <interface> (e.g., eth0). If not
	    specified, mydump will automatically select a default interface to
	    listen on.

	-r  Reads packets from <file> in tcpdump format.

	-s  Keeps only packets that contain <string> in their payload.


Get Started:
	$ make

		A output file with name mydump will be created.

	To run:

	$./mydump -r hw1.pcap tcp
		
	Sample Output:
		2013-01-12 14:35:49.329823 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 74 122.154.101.54:39437 -> 192.168.0.200:443  TCP

		2013-01-12 14:35:49.350673 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 74 192.168.0.200:443 -> 122.154.101.54:39437  TCP

		2013-01-12 14:35:49.679245 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 66 122.154.101.54:39437 -> 192.168.0.200:443  TCP

		2013-01-12 14:35:49.724737 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 171 122.154.101.54:39437 -> 192.168.0.200:443  TCP
		80 67 01 03 01 00 4e 00 00 00 10 00 00 39 00 00     .g....N......9..
		38 00 00 35 00 00 16 00 00 13 00 00 0a 07 00 c0     8..5............
		00 00 33 00 00 32 00 00 2f 03 00 80 00 00 05 00     ..3..2../.......
		00 04 01 00 80 00 00 15 00 00 12 00 00 09 06 00     ................
		40 00 00 14 00 00 11 00 00 08 00 00 06 04 00 80     @...............
		00 00 03 02 00 80 00 00 ff 0d 21 3b d5 b5 7b 08     ..........!;..{.
		01 50 0d c5 a5 c2 c1 af 38                          .P......8

		2013-01-12 14:35:49.724815 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 66 192.168.0.200:443 -> 122.154.101.54:39437  TCP

		2013-01-12 14:36:16.325480 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 66 122.154.101.54:39437 -> 192.168.0.200:443  TCP

		2013-01-12 14:36:16.328843 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 66 192.168.0.200:443 -> 122.154.101.54:39437  TCP

		2013-01-12 14:36:16.659193 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 66 122.154.101.54:39437 -> 192.168.0.200:443  TCP

		2013-01-12 22:04:11.271426 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 74 130.75.16.5:42035 -> 192.168.0.200:465  TCP

		2013-01-12 22:04:11.277133 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 74 192.168.0.200:465 -> 130.75.16.5:42035  TCP

		2013-01-12 22:04:11.323599 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 60 130.75.16.5:42035 -> 192.168.0.200:465  TCP

		2013-01-12 22:30:48.832497 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 74 92.240.68.152:9485 -> 192.168.0.200:80  TCP

		2013-01-12 22:30:48.846741 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 74 192.168.0.200:80 -> 92.240.68.152:9485  TCP

		2013-01-12 22:30:48.908396 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 66 92.240.68.152:9485 -> 192.168.0.200:80  TCP

		2013-01-12 22:30:48.908526 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 177 92.240.68.152:9485 -> 192.168.0.200:80  TCP
		47 45 54 20 68 74 74 70 3a 2f 2f 70 69 63 2e 6c     GET http://pic.l
		65 65 63 68 2e 69 74 2f 69 2f 66 31 36 36 63 2f     eech.it/i/f166c/
		34 37 39 32 34 36 62 30 61 73 74 74 61 73 2e 6a     479246b0asttas.j
		70 67 20 48 54 54 50 2f 31 2e 31 0a 55 73 65 72     pg HTTP/1.1.User
		2d 41 67 65 6e 74 3a 20 77 65 62 63 6f 6c 6c 61     -Agent: webcolla
		67 65 2f 31 2e 31 33 35 61 0a 48 6f 73 74 3a 20     ge/1.135a.Host: 
		70 69 63 2e 6c 65 65 63 68 2e 69 74 0a 0a 00        pic.leech.it...

	$./mydump -r hw1.pcap udp

	Sample Output:
		2013-01-12 11:38:02.227995 c4:3d:c7:17:6f:9b -> 01:00:5e:7f:ff:fa type 0x800 len 342 192.168.0.1:1901 -> 239.255.255.250:1900  UDP
		4e 4f 54 49 46 59 20 2a 20 48 54 54 50 2f 31 2e     NOTIFY * HTTP/1.
		31 0d 0a 48 4f 53 54 3a 20 32 33 39 2e 32 35 35     1..HOST: 239.255
		2e 32 35 35 2e 32 35 30 3a 31 39 30 30 0d 0a 43     .255.250:1900..C
		61 63 68 65 2d 43 6f 6e 74 72 6f 6c 3a 20 6d 61     ache-Control: ma
		78 2d 61 67 65 3d 33 36 30 30 0d 0a 4c 6f 63 61     x-age=3600..Loca
		74 69 6f 6e 3a 20 68 74 74 70 3a 2f 2f 31 39 32     tion: http://192
		2e 31 36 38 2e 30 2e 31 3a 38 30 2f 52 6f 6f 74     .168.0.1:80/Root
		44 65 76 69 63 65 2e 78 6d 6c 0d 0a 4e 54 3a 20     Device.xml..NT: 
		75 75 69 64 3a 75 70 6e 70 2d 49 6e 74 65 72 6e     uuid:upnp-Intern
		65 74 47 61 74 65 77 61 79 44 65 76 69 63 65 2d     etGatewayDevice-
		31 5f 30 2d 63 34 33 64 63 37 31 37 36 66 39 62     1_0-c43dc7176f9b
		0d 0a 55 53 4e 3a 20 75 75 69 64 3a 75 70 6e 70     ..USN: uuid:upnp
		2d 49 6e 74 65 72 6e 65 74 47 61 74 65 77 61 79     -InternetGateway
		44 65 76 69 63 65 2d 31 5f 30 2d 63 34 33 64 63     Device-1_0-c43dc
		37 31 37 36 66 39 62 0d 0a 4e 54 53 3a 20 73 73     7176f9b..NTS: ss
		64 70 3a 61 6c 69 76 65 0d 0a 53 65 72 76 65 72     dp:alive..Server
		3a 20 55 50 6e 50 2f 31 2e 30 20 55 50 6e 50 2f     : UPnP/1.0 UPnP/
		31 2e 30 20 55 50 6e 50 2d 44 65 76 69 63 65 2d     1.0 UPnP-Device-
		48 6f 73 74 2f 31 2e 30 0d 0a 0d 0a                 Host/1.0....

		2013-01-12 11:38:02.231699 c4:3d:c7:17:6f:9b -> 01:00:5e:7f:ff:fa type 0x800 len 398 192.168.0.1:1901 -> 239.255.255.250:1900  UDP
		4e 4f 54 49 46 59 20 2a 20 48 54 54 50 2f 31 2e     NOTIFY * HTTP/1.
		31 0d 0a 48 4f 53 54 3a 20 32 33 39 2e 32 35 35     1..HOST: 239.255
		2e 32 35 35 2e 32 35 30 3a 31 39 30 30 0d 0a 43     .255.250:1900..C
		61 63 68 65 2d 43 6f 6e 74 72 6f 6c 3a 20 6d 61     ache-Control: ma
		78 2d 61 67 65 3d 33 36 30 30 0d 0a 4c 6f 63 61     x-age=3600..Loca
		74 69 6f 6e 3a 20 68 74 74 70 3a 2f 2f 31 39 32     tion: http://192
		2e 31 36 38 2e 30 2e 31 3a 38 30 2f 52 6f 6f 74     .168.0.1:80/Root
		44 65 76 69 63 65 2e 78 6d 6c 0d 0a 4e 54 3a 20     Device.xml..NT: 
		75 72 6e 3a 73 63 68 65 6d 61 73 2d 75 70 6e 70     urn:schemas-upnp
		2d 6f 72 67 3a 64 65 76 69 63 65 3a 49 6e 74 65     -org:device:Inte
		72 6e 65 74 47 61 74 65 77 61 79 44 65 76 69 63     rnetGatewayDevic
		65 3a 31 0d 0a 55 53 4e 3a 20 75 75 69 64 3a 75     e:1..USN: uuid:u
		70 6e 70 2d 49 6e 74 65 72 6e 65 74 47 61 74 65     pnp-InternetGate
		77 61 79 44 65 76 69 63 65 2d 31 5f 30 2d 63 34     wayDevice-1_0-c4
		33 64 63 37 31 37 36 66 39 62 3a 3a 75 72 6e 3a     3dc7176f9b::urn:
		73 63 68 65 6d 61 73 2d 75 70 6e 70 2d 6f 72 67     schemas-upnp-org
		3a 64 65 76 69 63 65 3a 49 6e 74 65 72 6e 65 74     :device:Internet
		47 61 74 65 77 61 79 44 65 76 69 63 65 3a 31 0d     GatewayDevice:1.
		0a 4e 54 53 3a 20 73 73 64 70 3a 61 6c 69 76 65     .NTS: ssdp:alive
		0d 0a 53 65 72 76 65 72 3a 20 55 50 6e 50 2f 31     ..Server: UPnP/1
		2e 30 20 55 50 6e 50 2f 31 2e 30 20 55 50 6e 50     .0 UPnP/1.0 UPnP
		2d 44 65 76 69 63 65 2d 48 6f 73 74 2f 31 2e 30     -Device-Host/1.0
		0d 0a 0d 0a                                         ....

	$./mydump -r hw1.pcap -s GET

	Sample Output:
		2013-01-12 22:30:48.908526 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 177 92.240.68.152:9485 -> 192.168.0.200:80  TCP
		47 45 54 20 68 74 74 70 3a 2f 2f 70 69 63 2e 6c     GET http://pic.l
		65 65 63 68 2e 69 74 2f 69 2f 66 31 36 36 63 2f     eech.it/i/f166c/
		34 37 39 32 34 36 62 30 61 73 74 74 61 73 2e 6a     479246b0asttas.j
		70 67 20 48 54 54 50 2f 31 2e 31 0a 55 73 65 72     pg HTTP/1.1.User
		2d 41 67 65 6e 74 3a 20 77 65 62 63 6f 6c 6c 61     -Agent: webcolla
		67 65 2f 31 2e 31 33 35 61 0a 48 6f 73 74 3a 20     ge/1.135a.Host: 
		70 69 63 2e 6c 65 65 63 68 2e 69 74 0a 0a 00        pic.leech.it...

		2013-01-12 22:30:49.032953 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 229 192.168.0.200:40341 -> 87.98.246.8:80  TCP
		47 45 54 20 2f 69 2f 66 31 36 36 63 2f 34 37 39     GET /i/f166c/479
		32 34 36 62 30 61 73 74 74 61 73 2e 6a 70 67 20     246b0asttas.jpg 
		48 54 54 50 2f 31 2e 30 0d 0a 55 73 65 72 2d 41     HTTP/1.0..User-A
		67 65 6e 74 3a 20 4d 6f 7a 69 6c 6c 61 2f 34 2e     gent: Mozilla/4.
		30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d     0 (compatible; M
		53 49 45 20 36 2e 30 3b 20 57 69 6e 64 6f 77 73     SIE 6.0; Windows
		20 4e 54 20 35 2e 31 29 0d 0a 41 63 63 65 70 74      NT 5.1)..Accept
		3a 20 2a 2f 2a 0d 0a 48 6f 73 74 3a 20 70 69 63     : */*..Host: pic
		2e 6c 65 65 63 68 2e 69 74 3a 38 30 0d 0a 43 6f     .leech.it:80..Co
		6e 6e 65 63 74 69 6f 6e 3a 20 63 6c 6f 73 65 0d     nnection: close.
		0a 0d 0a                                            ...

		2013-01-12 22:31:19.154432 c4:3d:c7:17:6f:9b -> 00:0c:29:e9:94:8e type 0x800 len 207 92.240.68.152:17260 -> 192.168.0.200:80  TCP
		47 45 54 20 68 74 74 70 3a 2f 2f 65 63 78 2e 69     GET http://ecx.i
		6d 61 67 65 73 2d 61 6d 61 7a 6f 6e 2e 63 6f 6d     mages-amazon.com
		2f 69 6d 61 67 65 73 2f 49 2f 34 31 6f 5a 31 58     /images/I/41oZ1X
		73 69 4f 41 4c 2e 5f 53 4c 35 30 30 5f 41 41 33     siOAL._SL500_AA3
		30 30 5f 2e 6a 70 67 20 48 54 54 50 2f 31 2e 31     00_.jpg HTTP/1.1
		0a 55 73 65 72 2d 41 67 65 6e 74 3a 20 77 65 62     .User-Agent: web
		63 6f 6c 6c 61 67 65 2f 31 2e 31 33 35 61 0a 48     collage/1.135a.H
		6f 73 74 3a 20 65 63 78 2e 69 6d 61 67 65 73 2d     ost: ecx.images-
		61 6d 61 7a 6f 6e 2e 63 6f 6d 0a 0a 00              amazon.com...

	$./mydump -r hw1.pcap udp -s iPhone

	Sample Ouput:
		2013-01-12 11:40:25.583510 3c:d0:f8:4e:4b:a1 -> ff:ff:ff:ff:ff:ff type 0x800 len 342 0.0.0.0:68 -> 255.255.255.255:67  UDP
		01 01 06 00 b7 8a 63 f6 00 02 00 00 00 00 00 00     ......c.........
		00 00 00 00 00 00 00 00 00 00 00 00 3c d0 f8 4e     ............<..N
		4b a1 00 00 00 00 00 00 00 00 00 00 00 00 00 00     K...............
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 63 82 53 63     ............c.Sc
		35 01 03 37 06 01 03 06 0f 77 fc 39 02 05 dc 3d     5..7.....w.9...=
		07 01 3c d0 f8 4e 4b a1 32 04 c0 a8 00 0a 33 04     ..<..NK.2.....3.
		00 76 a7 00 0c 0e 54 68 6f 6d 61 73 73 2d 69 50     .v....Thomass-iP
		68 6f 6e 65 ff 00 00 00 00 00 00 00                 hone........

		2013-01-12 11:46:20.803421 3c:d0:f8:4e:4b:a1 -> ff:ff:ff:ff:ff:ff type 0x800 len 342 0.0.0.0:68 -> 255.255.255.255:67  UDP
		01 01 06 00 b7 8a 63 f7 00 02 00 00 00 00 00 00     ......c.........
		00 00 00 00 00 00 00 00 00 00 00 00 3c d0 f8 4e     ............<..N
		4b a1 00 00 00 00 00 00 00 00 00 00 00 00 00 00     K...............
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ................
		00 00 00 00 00 00 00 00 00 00 00 00 63 82 53 63     ............c.Sc
		35 01 03 37 06 01 03 06 0f 77 fc 39 02 05 dc 3d     5..7.....w.9...=
		07 01 3c d0 f8 4e 4b a1 32 04 c0 a8 00 0a 33 04     ..<..NK.2.....3.
		00 76 a7 00 0c 0e 54 68 6f 6d 61 73 73 2d 69 50     .v....Thomass-iP
		68 6f 6e 65 ff 00 00 00 00 00 00 00                 hone........

	$./mydump "src port 443" -r hw1.pcap

	Sample Output:
		2013-01-12 14:35:49.350673 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 74 192.168.0.200:443 -> 122.154.101.54:39437  TCP

		2013-01-12 14:35:49.724815 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 66 192.168.0.200:443 -> 122.154.101.54:39437  TCP

		2013-01-12 14:36:16.328843 00:0c:29:e9:94:8e -> c4:3d:c7:17:6f:9b type 0x800 len 66 192.168.0.200:443 -> 122.154.101.54:39437  TCP
